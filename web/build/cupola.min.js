/*! cupola 2013-11-10 */
var Cupola=function(a){a=a?a:{};var b={x:0,y:0,z:0,w:1},c={FOV:125.871,hScreenSize:.14976,vScreenSize:.0935,vScreenCenter:.04675,eyeToScreenDistance:.041,lensSeparationDistance:.067,interpupillaryDistance:.0675,hResolution:1280,vResolution:720,distortionK:[1,.22,.24,0],chromaAbParameter:[.996,-.004,1.014,0],gender:"Unspecified",playerHeight:1.778},d=!1,e=a.hasOwnProperty("debug")?a.debug:!1,f={onOrientationUpdate:null,onConfigUpdate:null,onConnect:null,onDisconnect:null};for(var g in f)"function"==typeof a[g]&&(f[g]=a[g]);var h=function(a){e&&console.log("Cupola client: "+a)},i=function(){h("connect()"),d||(d=!0,f.onConnect&&(h("invoking onConnect callback"),f.onConnect()))},j=function(){h("disconnect()"),d&&(d=!1,f.onDisconnect&&(h("invoking onDisconnect callback"),f.onDisconnect()))},k=function(){return h("isConnected()"),d},l=function(){return h("getOrientation()"),b},m=function(){return h("getConfiguration()"),c},n=function(a){if(a&&"object"==typeof a){for(var c in a)b[c]=a[c];f.onOrientationUpdate&&(h("invoking onOrientationUpdate callback"),f.onOrientationUpdate(b))}},o=function(a){if(quat&&"object"==typeof quat){for(var b in a)c[b]=a[b];f.onConfigUpdate&&(h("invoking onConfigUpdate callback"),f.onConfigUpdate(c))}};return window.addEventListener("message",function(a){if(d){h("received message");var b=a.data;if(b&&"object"==typeof b){var c=(b.version,b.msg),e=b.data;switch(c){case"quat":h("received new orientation data"),n(e);break;case"config":h("got config from viewer"),o(e);break;default:h("unrecognized message from Cupola viewer: "+JSON.stringify(b))}}}}),{isConnected:k,disconnect:j,connect:i,getOrientation:l,getConfiguration:m}};